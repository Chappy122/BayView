#!/bin/bash
FILE=.built
start=0
build=0
help=0

if [[ $1 == '' ]]; then
    start=1

    if [[ -f "$FILE" ]]; then 
      build=0
    else 
      build=1 
    fi 

fi

while [[ "$#" -gt 0 ]]; do
    case $1 in
        -s|--start) start=1; shift ;;
        -b|--build) build=1;;
        -h|--help) help=1;;
        *) echo "Unknown parameter passed: $1"; exit 1 ;;
    esac
    shift
done

if [[ $help == 1 ]]; then
    echo
    echo "$0 [-bs]|[--build|start]"
    echo
    echo ' Builds and runs the Docker container.'
    echo
    echo "-------------------------------------------------"
    echo
    echo "Options:"
    echo
    echo "  -s | --start      : Start the docker container."
    echo "  -b | --build      : Build the docker container."
    echo
    echo "-------------------------------------------------"
    echo
    echo "Note: Can be specified for individual operations."
    exit 1
    
fi

if [[ $build == 1 ]]; then
    
    docker compose up --build --no-start 
    
    date=`date`
    echo 'Created Build on:' $date >> .built
    
fi;

if [[ $start == 1 ]]; then
    
    docker start -ia bayview-development
    
fi;
